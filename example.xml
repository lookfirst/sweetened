<?xml version="1.0" encoding="UTF-8"?>

<project basedir="." name="sweetened-example" default=".eclipse">

    <property file="jar.properties"/>
    <property name="lib.dir" value="lib"/>
    <property name="target.dir" value="target"/>
    <property name="project.name" value="${ant.project.name}"/>
    <property name="alexandria.dir" value="../alexandria"/>
    <!--
        Inside of the alexandria jar.properties file, it looks like this:

        junit.jar=thirdparty/junit-2.8.2.jar
    -->
    <property file="${alexandria.dir}/jar.properties"/>
    <typedef resource="com/googlecode/sweetened/sweetened.xml">
        <classpath>
            <fileset dir="${target.dir}">
                <include name="sweetened.jar"/>
            </fileset>
        </classpath>
    </typedef>

    <sweetenedPath id="filelist.classpath">
        <sweetenedFileList dir="${lib.dir}">
            <sweetenedFile name="${ant.jar}" scope="compile" />
            <sweetenedFile name="svntask.jar" scope="runtime" />
        </sweetenedFileList>
        <sweetenedFileList dir="${target.dir}">
            <sweetenedFile name="sweetened.jar" src="src" scope="runtime" />
        </sweetenedFileList>
        <sweetenedFileList dir="${alexandria.dir}">
            <sweetenedFile name="${junit.jar}" scope="compile" />
        </sweetenedFileList>
    </sweetenedPath>

	<target name=".eclipse">
		<sweetenedClasspath file="${target.dir}/varClasspath"
		    var="ALEXANDRIA_HOME" varpath="${alexandria.dir}" sourcepath="src"
		    property="sweetenedVar" debug="true">
            <sweetenedBits refid="filelist.classpath" />
			<![CDATA[<?xml version="1.0" encoding="UTF-8"?>
			<classpath>
                <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER"/>
                <classpathentry kind="lib" path="bin/log4j/dev"/>
                <classpathentry kind="lib" path="etc"/>
                ${sweetenedVar}
                <classpathentry kind="lib" path="resources/publisher"/>
                <classpathentry kind="src" path="src"/>
                <classpathentry kind="src" path="test/java"/>
                <classpathentry kind="output" path="build/classes"/>
	        </classpath>]]>
	    </sweetenedClasspath>
        <sweetenedClasspath file="${target.dir}/libClasspath" sourcepath="src" debug="true">
            <sweetenedBits refid="filelist.classpath" />
            <![CDATA[<?xml version="1.0" encoding="UTF-8"?>
                <classpath>
            	<classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER"/>
                <classpathentry kind="lib" path="bin/log4j/dev"/>
                <classpathentry kind="lib" path="etc"/>
                ${sweetened}
                <classpathentry kind="lib" path="resources/publisher"/>
                <classpathentry kind="src" path="src"/>
                <classpathentry kind="src" path="test/java"/>
                <classpathentry kind="output" path="build/classes"/>
            </classpath>]]>
        </sweetenedClasspath>

        <echo file="${target.dir}/project"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
            <projectDescription>
                <name>${project.name}</name>
                <comment></comment>
                <projects>
                </projects>
                <buildSpec>
                    <buildCommand>
                        <name>org.eclipse.jdt.core.javabuilder</name>
                        <arguments>
                        </arguments>
                    </buildCommand>
                </buildSpec>
                <natures>
                    <nature>org.eclipse.jdt.core.javanature</nature>
                </natures>
            </projectDescription>]]>
        </echo>
	</target>

</project>
